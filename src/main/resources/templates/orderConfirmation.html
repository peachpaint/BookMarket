<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>주문정보</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <div class="container py-4">
      <header class="py-3 mb-4 border-bottom">
        <div class="container d-flex flex-wrap justify-content-center">
          <a
            th:href="@{/home}"
            class="d-flex align-items-center link-body-emphasis text-body-emphasis text-decoration-none mb-3 mb-lg-0 me-lg-auto"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="32"
              height="32"
              fill="currentColor"
              class="bi bi-book-half me-2"
              viewBox="0 0 16 16"
            >
              <path
                d="M8.5 2.687c.654-.689 1.782-.886 3.112-.752 1.234.124 2.503.523 3.388.893v9.923c-.918-.35-2.107-.692-3.287-.81-1.094-.111-2.278-.039-3.213.492zM8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.042.672-3.994 1.105A.5.5 0 0 0 0 2.5v11a.5.5 0 0 0 .707.455c.882-.4 2.303-.881 3.68-1.02 1.409-.142 2.59.087 3.223.877a.5.5 0 0 0 .78 0c.633-.79 1.814-1.019 3.222-.877 1.378.139 2.8.62 3.681 1.02A.5.5 0 0 0 16 13.5v-11a.5.5 0 0 0-.293-.455c-.952-.433-2.48-.952-3.994-1.105C10.413.809 8.985.936 8 1.783"
              />
            </svg>
            <span class="fs-4">BookMarket</span>
          </a>
        </div>
      </header>

      <div class="p-5 mb-4 bg-body-tertiary rounded-3">
        <div class="container-fluid py-5">
          <h1 class="display-5 fw-bold">주문정보</h1>
          <p class="col-md-8 fs-4">BookMarket</p>
        </div>
      </div>

      <div class="row align-items-md-stretch">
        <form
          th:object="${order}"
          action="/BookMarket/orders/orderConfirmation"
          method="post"
          class="form-horizontal"
        >
          <div class="container col-md-10 py-5" style="background: #fafafe">
            <div class="text-center mb-4">
              <h1>주문 확인</h1>
              <!-- 임시 주문 번호 표시 -->
              <p class="text-muted" th:if="${order.tempOrderId != null}">
                주문번호:
                <strong th:text="${order.tempOrderId}">ORD-xxx-123</strong>
              </p>
            </div>

            <!-- 배송 정보 -->
            <div class="row mb-4">
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header bg-primary text-white">
                    <h5 class="mb-0">배송 정보</h5>
                  </div>
                  <div class="card-body">
                    <p>
                      <strong>수취인:</strong>
                      <span th:text="${order.delivery?.recipientName}"
                        >홍길동</span
                      >
                    </p>
                    <p>
                      <strong>국가:</strong>
                      <span
                        th:text="${order.delivery?.deliveryAddress?.country}"
                        >대한민국</span
                      >
                    </p>
                    <p>
                      <strong>우편번호:</strong>
                      <span
                        th:text="${order.delivery?.deliveryAddress?.zipcode}"
                        >12345</span
                      >
                    </p>
                    <p>
                      <strong>주소:</strong>
                      <span
                        th:text="${order.delivery?.deliveryAddress?.addressname}"
                        >서울시 강남구 테헤란로 123</span
                      >
                    </p>
                    <p>
                      <strong>상세주소:</strong>
                      <span
                        th:text="${order.delivery?.deliveryAddress?.detailname}"
                        >101동 1001호</span
                      >
                    </p>
                    <p>
                      <strong>배송메모:</strong>
                      <span th:text="${order.delivery?.note}">-</span>
                    </p>
                  </div>
                </div>
              </div>

              <!-- 청구 주소 (회원 정보) -->
              <div class="col-md-6">
                <div class="card">
                  <div class="card-header bg-success text-white">
                    <h5 class="mb-0">청구 주소</h5>
                  </div>
                  <div class="card-body">
                    <p>
                      <strong>주문자:</strong>
                      <span th:text="${order.member?.name}">홍길동</span>
                    </p>
                    <p>
                      <strong>전화번호:</strong>
                      <span th:text="${order.member?.phone}"
                        >010-0000-0000</span
                      >
                    </p>
                    <p>
                      <strong>거주지:</strong>
                      <span th:text="${order.member?.city}">서울시</span>
                    </p>
                    <p>
                      <strong>회원 ID:</strong>
                      <span th:text="${order.member?.memberId}">user01</span>
                    </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- 주문 도서 목록 -->
            <div class="card mb-4">
              <div class="card-header bg-info text-white">
                <h5 class="mb-0">주문 도서</h5>
              </div>
              <div class="card-body">
                <table class="table table-hover">
                  <thead>
                    <tr>
                      <th>도서명</th>
                      <th>저자</th>
                      <th>출판사</th>
                      <th class="text-end">가격</th>
                      <th class="text-center">수량</th>
                      <th class="text-end">소계</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr th:each="item : ${order.orderItems}">
                      <td th:text="${item.book.name}">도서명</td>
                      <td th:text="${item.book.author}">저자</td>
                      <td th:text="${item.book.publisher}">출판사</td>
                      <td class="text-end">
                        <span
                          th:text="${#numbers.formatDecimal(item.orderPrice, 0, 'COMMA', 0, 'NONE')} + '원'"
                          >15,000원</span
                        >
                      </td>
                      <td class="text-center" th:text="${item.quantity}">1</td>
                      <td class="text-end">
                        <span
                          th:text="${#numbers.formatDecimal(item.totalPrice, 0, 'COMMA', 0, 'NONE')} + '원'"
                          >15,000원</span
                        >
                      </td>
                    </tr>
                  </tbody>
                  <tfoot>
                    <tr>
                      <td colspan="5" class="text-end">
                        <strong>총 주문 금액:</strong>
                      </td>
                      <td class="text-end">
                        <strong>
                          <span
                            th:text="${#numbers.formatDecimal(order.totalPrice, 0, 'COMMA', 0, 'NONE')} + '원'"
                            >30,000원</span
                          >
                        </strong>
                      </td>
                    </tr>
                  </tfoot>
                </table>
              </div>
            </div>

            <!-- 버튼 -->
            <div class="text-center">
              <button type="submit" class="btn btn-primary btn-lg">
                주문 확정
              </button>
              <a
                th:href="@{/orders/orderCancelled}"
                class="btn btn-secondary btn-lg"
                >주문 취소</a
              >
            </div>
          </div>
        </form>
      </div>
    </div>
  </body>
</html>
